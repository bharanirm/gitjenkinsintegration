def sourceFolder = "D:\\Bharani\\Projects\\gitjenkins\\app\\"
def destinationFolder = "D:\\Bharani\\Projects\\gitjenkins\\app\\appdeploy\\"
pipeline {
    agent {
        label 'WindowsNode'
    }
    stages {
        stage('Checkout') {
            steps {
                
                    git url: 'https://github.com/bharanirm/gitjenkinsintegration.git', branch: 'master', credentialsId: '6153a06b50ce4c3cf2b0317abcb88c92e8a4adb4'
                
            }
        }
        stage('Organise Files'){                         
         steps{  
                script{       
                  /* bat("xcopy D:\\Bharani\\Projects\\gitjenkins\\app\\ D:\\Bharani\\Projects\\gitjenkins\\app\\appdeploy\\ /s /i /r")   */              
                  /*  File sourceFolder = new File("D:\\Bharani\\Projects\\gitjenkins\\app");
                    File  destinationFolder = new File("D:\\Bharani\\Projects\\gitjenkins\\app\\appdeploy");                                                   
                    File[] listOfFiles = sourceFolder.listFiles();
                    echo "Files Total: " + listOfFiles.length;  

                    for (File file : listOfFiles) {
                        if (file.isFile()) {
                            echo file.getName()                                                                
                            Files.copy(Paths.get(file.path), Paths.get("D:\\Bharani\\Projects\\gitjenkins\\app\\appdeploy"));                                   
                        }
                    }     */
                  /*  fileOperations([fileCopyOperation(
                    excludes: '',
                    flattenFiles: false,
                    includes: "D:\\Bharani\\Projects\\gitjenkins\\app\\**",
                    targetLocation: "D:\\Bharani\\Projects\\gitjenkins\\app\\appdeploy\\**")]) 
                    */
                    fileOperations([fileCopyOperation(excludes: '', flattenFiles: false, includes: 'D:\\Bharani\\Projects\\gitjenkins\\app\\', targetLocation: 'D:\\Bharani\\Projects\\gitjenkins\\app\\appdeploy\\')])

                   /* def srcStream = new File("D:\\Bharani\\Projects\\gitjenkins\\app\\**").newDataInputStream()
                    def dstStream = new File("D:\\Bharani\\Projects\\gitjenkins\\app\\appdeploy").newDataOutputStream()
                    dstStream << srcStream
                    srcStream.close()
                    dstStream.close()    
                    */      
                }                                
            }                           
        } 
        stage('Example') {
            steps {
                echo "Running ${env.BUILD_ID} on ${env.JENKINS_URL}"
            }
        }
        }
    } 